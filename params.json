{"name":"Appetite-textmining-code","tagline":"Using GATE to text mine 'appetite'","body":"# Text Mining for Non-Professionals. \r\n\r\n## Basic Example: Using Text Mining to Code appetite (variable) in a dataset as \"good\" or \"bad\". \r\n\r\n\r\n\r\n**Using Text mining software - [GATE](https://gate.ac.uk/family/) - to extract a data variable (appetite) from free text clinical notes (and code appetite as good or bad).**\r\n\r\n\r\nThis is a record of my [JAPE](https://gate.ac.uk/sale/tao/splitch8.html#chap:jape) code to text mine the variable \"appetite\" within a bespoke psychiatric health record database, [CRIS](http://www.slam.nhs.uk/about/core-facilities/cris). \r\n\r\nIt is mainly for my own records but also functions as a link to send out to anyone interested. \r\n\r\n\r\n####About Author\r\n| Author Name | Andrea Fernandes| \r\n|:--------|:--------------:|\r\n|Occupation| PhD student, 2nd Year|\r\n|Email | andrea.fernandes@kcl.ac.uk|\r\n|University|King's College London|\r\n|Funding| MHRUK - Mental Health Research UK|\r\n\r\n\r\n\r\n| **Data source**     | **[CRIS](http://www.slam.nhs.uk/\t\t\t\t\t\t\t\t\tabout/core-facilities/cris) - \t\t\t\t\t\t\t\t\tPseudonymised electronic \t\t\t\t\t\t\t\t\tpsychiatric healthcare records** | \r\n|:--------------------|:------------|\r\n|**Data extracted**   | **Clinical notes with the term \t\t\t\t\t\t\t'appetite' menioned were extracted \t\t\t\t\t\t\t and processed to be read by GATE. \t\t\t\t\t\t\t Contact author for details on this.** |\r\n|**Text-mining software** | **[GATE](www.gate.ac.uk)**|\r\n|\r\n|**Level of Training**| **I'd say Beginner Level**\r\n\t\t\t\t\t\t\t|**GATE 5 day training course: Included: how to create gazateers, how to write JAPE code and run Machine Learning algorithms on GATE**|\r\n\r\n\r\n\r\n**********\r\n\r\n\r\n**Purpose of 'Appetite Variable'**   \r\nThis code will highlight the term 'appetite' AND any terms which collectively describe either 'good' or 'poor' appetite.\r\n\r\n\r\n*************\r\n##Standard Steps to Build a Text Mining Application\r\nI followed the following steps to create a functioning code to textmine appetite from CRIS records. \r\n\r\nI came up with these steps from a trial and error phase - trying to learn GATE (writing JAPE code), defining what I wanted the eventual produc to look like and understanding how data is recording in the data source. \r\n\r\nSo these steps may be bespoke to my learning experience but I would apply them if I ever wanted to text-mine again. \r\n\r\n\r\n**1) Define the Problem/Variable**\r\n\r\nDefine and think through what it is you want to extract. Think of your variable outcome. What type of data would you like your outcome variable to display? What do you want this variable to inform you of? \r\n\r\nSo try to write a set of rules, which  \r\n\r\n - Define your variable of interest and \r\n - Inform of what you want out of your textmining code eventually\r\n\r\n\r\nMake sure to give some examples, if you think this will help you define you problem/variable. \r\n\r\n\r\n**2) Scoping Exercise**\r\n\r\nTo help with understanding what it is what you want from the free-text data (or from your dataset) and to generate tools that you'll need to build your text mining application, conduct a scoping exercise. \r\n\r\nGo through around 500 to 1000 documents in your dataset which contain the data that you are interested in. \r\n\r\nDuring this exercise you aim is to meet each of the following:  \r\n\r\n- Familiarise yourself with how your variable of interest is being mentioned in your dataset \r\n- do some exemplar coding of data; at least 500 documents\r\n- make a note of and develop resolutions to ant issues you think you may face\r\n- what are common terms/words associated with the main variable.\r\n- Make a List of terms/words that you come across in a .lst files\r\n- What terms make your variable of interest redundant or negate the variable\r\n- Make a list of these terms that you like your application to exclude\r\n\r\n\r\n**3) Re-define Problem**\r\n\r\nHaving done the scoping exercise, go back to your problem/variable definition. Read through it and see if you can add any extra examples, rules or notes to make your definition explicit. Give examples and lists of terms if you think it will help with the definition. \r\n\r\n\r\n**4) Thorough Consultation Process**\r\n\r\nSet up a thorough consultation process with relevant colleagues and supervisors (and experts in the field) to make sure you've covered your bases with: explaing your variable, defining solution to overcome each issue you face to mining this variable. Show them the document you put together and make sure they understand what is on the document. \r\n\r\nBased on feedback, make any revisions to your document.\r\n\r\n\r\n\r\n***At this point you should have:***\r\n\r\n\r\n- ***A clear definition of your variable (Gold Standard Rules)***\r\n- ***Lists: One or more lists (.lst files) of terms that describe each aspect of your variable (GATE calls these Gazateers).***\r\n- ***JAPE code knowledge beginner level: Make sure you have had some GATE training to start up JAPE***\r\n\r\n*If you are have the above then continue to the next steps:*\r\n\r\n**5) Extract documents for Training Set and Gold Standard.** \r\n\r\nExtract 500 random documents for each set.\r\n\r\n**6) Annotate Training Set**\r\n\r\nBased on your polished rules from Step 3) annotate the Training Set set.\r\n\r\nIdeally you should get two annotators to annotate your Training Set and check Inter-rater Reliability to minimise bias or skewed annotations. If performance from this is low, then you'll need repeat Steps 1 to 5, with a second annotator input. \r\n\r\n\r\n**7) Annotate the Gold Standard**\r\n\r\n\r\nWhen you are happy with the training set, proceed to Annotating the Gold Standard the same way as you did with the Training set.  \r\n\r\n**8) Write JAPE and Create Gazateers**\r\n\r\nBased on your Gold Standard Rules, begin to write JAPE and make use of your lists. \r\n\r\nYou can continuously test your JAPE and Gazateers out on smaller document sets to make sure the JAPE is doing what you want it to do. Just make sure these documents are not part of the training set or the Gold Standard. \r\n\r\n**9) Evaluate Application**\r\n\r\nTest out final Gazateer list and JAPE on Gold-Standard\r\n\r\n\r\n\r\n*************\r\n##GATE Application to Extract Appetite\r\n\r\n\r\n**Result of Scoping Exercise**\r\n\r\nI developed a simple set of rules to code appetite: ![GOLD STANDARD RULES](https://cloud.githubusercontent.com/assets/10629155/12238166/95b70598-b87a-11e5-9fe6-dcefe1bd904b.png) \r\n\r\n#### GAZATEERS\r\n\r\nA Gazateer is - basically -  a list of terms stored in a .lst file. \r\n\r\nI used 5 gazateers to help me pick up \"good\" or \"bad appetite\" (The list of terms were derived from scoping exercises on CRIS, whose aim was to determine the types of words used to describe appetite in CRIS). \r\n\r\nHere's the list of .lst files I generated. These are in the \"gazateer\" repository: \r\n\r\n###### Gazateer 1: appetite_gazateer.lst file \r\n\r\n###### Gazateer 2: appetite poor describe.lst \r\n\r\n###### Gazateer 3: appetite good describe.lst\r\n\r\n###### Gazateer 4: negation.lst\r\n\r\n###### Gazateer 5: symptom_gazateer.lst \r\n\r\n\r\nThese .lst files are then saved into a single  .def file, which looks like so:\r\n\r\n\r\n```\r\nappetite_gazateer.lst:appetite_mention\r\nappetite_poor_describe.lst:appetite_description:poor\r\nappetite_good_describe.lst:appetite_description:good\r\nnegation.lst:negationterms:negation\r\nsymptom_gazateer.lst:Symptom:symptoms\r\n```\r\n\r\n\r\n\r\n#### JAPE CODE\r\n\r\nThis jape code was written after going through the Training set data (500 documents) and matched each Rule from the Gold Standard document.\r\n\r\n\r\n######FINAL JAPE code\r\n\r\n\r\n```\r\nPhase: Appetite\r\nInput: Lookup Token Split\r\nOptions: control = appelt\r\n\r\n\r\n\r\nRule: AppetiteThenDescriber\r\nPriority: 10\r\n\r\n(\r\n\r\n\t({Token.string =~ \"[Aa]ppetite\", !Lookup.MajorType == \"Symptom\"}):SymptomAppetiteOnly\r\n\r\n\t({Lookup.minorType == \"good\"} | \r\n \t {Lookup.minorType == \"poor\"}):descriptorsOfAppetite\r\n\r\n):AppetiteDescription\r\n-->\r\n:AppetiteDescription.Appetite = {rule = \"AppetiteDescription1\", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = \"no\"}\r\n\r\n\r\n\r\n\r\nRule: AppetiteThenDescriber\r\nPriority: 9\r\n(\r\n\r\n\t({Token.string =~ \"[Aa]ppetite\", !Lookup.MajorType == \"Symptom\"}):SymptomAppetiteOnly\r\n\r\n\t {Token.category == \":\", Token.category != \",\"} \r\n\t({Lookup.minorType == \"good\"} | \r\n  \t {Lookup.minorType == \"poor\"}):descriptorsOfAppetite\r\n\r\n):AppetiteDescription\r\n-->\r\n:AppetiteDescription.Appetite = {rule = \"AppetiteDescription2\", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = \"no\"}\r\n\r\n\r\n\r\n\r\nRule: DescriberThenAppetite\r\nPriority: 9\r\n(\r\n\r\n\t({Lookup.minorType == \"good\"} | \r\n\t {Lookup.minorType == \"poor\"}):descriptorsOfAppetite\r\n\t {Token.category != \",\"}\r\n\t({Token.string =~ \"[Aa]ppetite\", !Lookup.MajorType == \"Symptom\"}):SymptomAppetiteOnly\r\n\r\n):AppetiteDescription\r\n-->\r\n:AppetiteDescription.Appetite = {rule = \"AppetiteDescription3\", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = \"no\"}\r\n\r\n\r\n\r\n\r\nRule: DescriberThenAppetite\r\nPriority: 8\r\n(\r\n\r\n\t({Lookup.minorType == \"good\"} | \r\n\t {Lookup.minorType == \"poor\"}):descriptorsOfAppetite\r\n\t {Token.category != \",\"}\r\n\t({Token,!Split})[0,3]\r\n\t({Token.string =~ \"[Aa]ppetite\", !Lookup.MajorType == \"Symptom\"}):SymptomAppetiteOnly\r\n\r\n):AppetiteDescription\r\n-->\r\n:AppetiteDescription.Appetite = {rule = \"AppetiteDescription4\", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = \"no\"}\r\n\r\n\r\n\r\n\r\nRule: AppetiteThenDescriber\r\nPriority: 7\r\n(\r\n\r\n\t({Token.string =~ \"[Aa]ppetite\", !Lookup.MajorType == \"Symptom\"}):SymptomAppetiteOnly\r\n\t({Token,!Split})[0,3]\r\n\t {Token.category != \",\"}\r\n\t({Lookup.minorType == \"good\"} | \r\n\t {Lookup.minorType == \"poor\"}):descriptorsOfAppetite\r\n\r\n):AppetiteDescription\r\n-->\r\n:AppetiteDescription.Appetite = {rule = \"AppetiteDescription5\", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = \"no\"}\r\n\r\n\r\n\r\n\r\nRule: AppetiteThenDescriber\r\nPriority: 7\r\n(\r\n\r\n\t({Lookup.minorType == negation}):Negationwords\r\n\t({Token,!Split})[0,3]\r\n\t({Lookup.minorType == \"good\"}  | \r\n\t {Lookup.minorType == \"poor\"}):descriptorsOfAppetite\r\n\t({Token,!Split})[0,3]\r\n\t({Token.string =~ \"[Aa]ppetite\", !Lookup.MajorType == \"Symptom\"}):SymptomAppetiteOnly\r\n\r\n):AppetiteDescriptionwithNegation\r\n-->\r\n:AppetiteDescriptionwithNegation.Appetite = {rule = \"AppetiteDescriptionwithNegation6\", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = \"yes\"}\r\n\r\n\r\n\r\n\r\nRule: AppetiteThenDescriber\r\nPriority: 6\r\n(\r\n\r\n\t({Token.string =~ \"[Aa]ppetite\", !Lookup.MajorType == \"Symptom\"}):SymptomAppetiteOnly\t\r\n\t({Token,!Split})[0,3]\r\n\t({Lookup.minorType == negation}):Negationwords\r\n\t({Token,!Split})[0,3]\r\n\t({Lookup.minorType == \"good\"}  | \r\n\t {Lookup.minorType == \"poor\"}):descriptorsOfAppetite\r\n\r\n):AppetiteDescriptionwithNegation\r\n-->\r\n:AppetiteDescriptionwithNegation.Appetite = {rule = \"AppetiteDescriptionwithNegation7\", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = \"yes\"}\r\n\r\n\r\n\r\n\r\nRule: AppetiteThenDescriber\r\nPriority: 6\r\n(\r\n\r\n\t({Token.string =~ \"[Nn]o\"})\r\n\t({!Token.string == \"change\"})\r\n\t({Token,!Split})[0,3]\r\n\t({Token.string =~ \"[Aa]ppetite\", !Lookup.MajorType == \"Symptom\"}):SymptomAppetiteOnly\r\n\t({Token.string =~ \"[Pp]roblems\"})\r\n\r\n):AppetiteDescriptionwithNegation\r\n-->\r\n:AppetiteDescriptionwithNegation.Appetite = {rule = \"AppetiteDescriptionwithNegation8\", AppetiteType = \"good\" ApplyNegation = \"no\"}\r\n```\r\n \r\n\r\n\r\n***********************************\r\n## Testing the Application\r\n\r\nWe need to some Gold Standard data to test the above Gazateers and Code. \r\n\r\nThe final application was run over the Gold Standard documents. \r\n\r\n###Final Performance\r\n\r\nTesting on Gold Standard data (500 documents) generated a **_Precision_** of **80%** and a **_Recall_** of **73%.**\r\n\r\n\r\n\r\n********\r\n\r\n#Conclusions\r\nGATE is a user friendly text mining application that can be used by students, given initial introductory training. In my application above, there is room for improvement. \r\n\r\nFurther GATE machine learning applications, increased the precision to 83% and recall to 87%.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}