<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Appetite-textmining-code : Using GATE to text mine &#39;appetite&#39;">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Appetite-textmining-code</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/andreafernandes/appetite-textmining-code">View on GitHub</a>

          <h1 id="project_title">Appetite-textmining-code</h1>
          <h2 id="project_tagline">Using GATE to text mine &#39;appetite&#39;</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/andreafernandes/appetite-textmining-code/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/andreafernandes/appetite-textmining-code/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="appetite-textmining-code" class="anchor" href="#appetite-textmining-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>appetite-textmining-code</h1>

<p><strong>Using <a href="https://gate.ac.uk/family/">GATE</a> to text mine a data variable, which happens to be 'appetite'</strong></p>

<p>This repo is a record of my <a href="https://gate.ac.uk/sale/tao/splitch8.html#chap:jape">JAPE</a> code to text mine the variable "appetite" within a bespoke psychiatric health record database, <a href="http://www.slam.nhs.uk/about/core-facilities/cris">CRIS</a>. </p>

<p>It is mainly for my own benefit but do feel free to contact me for suggestions, questions or constructive feedback!</p>

<h2>
<a id="about-author" class="anchor" href="#about-author" aria-hidden="true"><span class="octicon octicon-link"></span></a>About Author</h2>

<h3>
<a id="details-and-contact-information" class="anchor" href="#details-and-contact-information" aria-hidden="true"><span class="octicon octicon-link"></span></a>Details and Contact Information</h3>

<table>
<thead>
<tr>
<th align="left">Author Name</th>
<th align="left">Andrea Fernandes</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Occupation</td>
<td align="left">PhD student, 2nd Year</td>
</tr>
<tr>
<td align="left">Email</td>
<td align="left"><a href="mailto:andrea.fernandes@kcl.ac.uk">andrea.fernandes@kcl.ac.uk</a></td>
</tr>
<tr>
<td align="left">University</td>
<td align="left">King's College London</td>
</tr>
<tr>
<td align="left">Funding</td>
<td align="left">MHRUK - Mental Health Research UK</td>
</tr>
</tbody>
</table>

<hr>

<p>Purpose of 'Appetite Variable' -<br>
This code will highlight the term 'appetite' AND any terms which collectively describe either 'good' or 'poor' appetite.</p>

<table>
<thead>
<tr>
<th align="left">Data source</th>
<th align="left">
<a href="http://www.slam.nhs.uk/about/%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20core-facilities/cris">CRIS</a> - Pseudonymised                           electronic psychiatric healthcare                           records</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Data extracted</td>
<td align="left">Clinical notes with the term                            'appetite' menioned were extracted                           and processed to be read by GATE.                           Contact author for details on this.</td>
</tr>
<tr>
<td align="left">Text-mining software</td>
<td align="left"><a href="www.gate.ac.uk">GATE</a></td>
</tr>
</tbody>
</table>

<hr>

<h2>
<a id="training-data" class="anchor" href="#training-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training Data</h2>

<p>The following JAPE code and <a href="https://gate.ac.uk/sale/tao/splitch13.html">gazateers</a> were generated after using 500 documents, each of which had the term 'appetite' mentioned and each of which was coded by two separate annotators to describe "good" or "bad appetite". </p>

<p>Rules to code appetite were generated beforehand and were kept as simple as possible: <img src="https://cloud.githubusercontent.com/assets/10629155/12238166/95b70598-b87a-11e5-9fe6-dcefe1bd904b.png" alt="GOLD STANDARD RULES"> </p>

<h4>
<a id="gazateers" class="anchor" href="#gazateers" aria-hidden="true"><span class="octicon octicon-link"></span></a>GAZATEERS</h4>

<p>A Gazateer is - basically -  a list of terms stored in a .lst file. </p>

<p>I used 5 gazateers to help me pick up "good" or "bad appetite" (The list of terms were derived from scoping exercises on CRIS, whose aim was to determine the types of words used to describe appetite in CRIS). </p>

<p>Here's the list of .lst files I generated. These are in the "gazateer" repository: </p>

<h6>
<a id="gazateer-1-appetite_gazateerlst-file" class="anchor" href="#gazateer-1-appetite_gazateerlst-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gazateer 1: appetite_gazateer.lst file</h6>

<h6>
<a id="gazateer-2-appetite-poor-describelst" class="anchor" href="#gazateer-2-appetite-poor-describelst" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gazateer 2: appetite poor describe.lst</h6>

<h6>
<a id="gazateer-3-appetite-good-describelst" class="anchor" href="#gazateer-3-appetite-good-describelst" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gazateer 3: appetite good describe.lst</h6>

<h6>
<a id="gazateer-4-negationlst" class="anchor" href="#gazateer-4-negationlst" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gazateer 4: negation.lst</h6>

<h6>
<a id="gazateer-5-symptom_gazateerlst" class="anchor" href="#gazateer-5-symptom_gazateerlst" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gazateer 5: symptom_gazateer.lst</h6>

<p>These .lst files are then saved into a single  .def file, which looks like so:</p>

<pre><code>appetite_gazateer.lst:appetite_mention
appetite_poor_describe.lst:appetite_description:poor
appetite_good_describe.lst:appetite_description:good
negation.lst:negationterms:negation
symptom_gazateer.lst:Symptom:symptoms
</code></pre>

<h4>
<a id="jape-code" class="anchor" href="#jape-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>JAPE CODE</h4>

<p>This jape code was written after going through the Training set data (500 documents) and generating a set of "patterns" or themes in the text that appeared consistently or often in the documents, when describing appetite. </p>

<p>Based on the themes I wrote the following JAPE code, in chunks. I have each chunk priority to be run, according to how often these themes were mentioned in the text.</p>

<h6>
<a id="final-jape-code" class="anchor" href="#final-jape-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>FINAL JAPE code</h6>

<pre><code>Phase: Appetite
Input: Lookup Token Split
Options: control = appelt



Rule: AppetiteThenDescriber
Priority: 10

(

    ({Token.string =~ "[Aa]ppetite", !Lookup.MajorType == "Symptom"}):SymptomAppetiteOnly

    ({Lookup.minorType == "good"} | 
     {Lookup.minorType == "poor"}):descriptorsOfAppetite

):AppetiteDescription
--&gt;
:AppetiteDescription.Appetite = {rule = "AppetiteDescription1", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = "no"}




Rule: AppetiteThenDescriber
Priority: 9
(

    ({Token.string =~ "[Aa]ppetite", !Lookup.MajorType == "Symptom"}):SymptomAppetiteOnly

     {Token.category == ":", Token.category != ","} 
    ({Lookup.minorType == "good"} | 
     {Lookup.minorType == "poor"}):descriptorsOfAppetite

):AppetiteDescription
--&gt;
:AppetiteDescription.Appetite = {rule = "AppetiteDescription2", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = "no"}




Rule: DescriberThenAppetite
Priority: 9
(

    ({Lookup.minorType == "good"} | 
     {Lookup.minorType == "poor"}):descriptorsOfAppetite
     {Token.category != ","}
    ({Token.string =~ "[Aa]ppetite", !Lookup.MajorType == "Symptom"}):SymptomAppetiteOnly

):AppetiteDescription
--&gt;
:AppetiteDescription.Appetite = {rule = "AppetiteDescription3", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = "no"}




Rule: DescriberThenAppetite
Priority: 8
(

    ({Lookup.minorType == "good"} | 
     {Lookup.minorType == "poor"}):descriptorsOfAppetite
     {Token.category != ","}
    ({Token,!Split})[0,3]
    ({Token.string =~ "[Aa]ppetite", !Lookup.MajorType == "Symptom"}):SymptomAppetiteOnly

):AppetiteDescription
--&gt;
:AppetiteDescription.Appetite = {rule = "AppetiteDescription4", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = "no"}




Rule: AppetiteThenDescriber
Priority: 7
(

    ({Token.string =~ "[Aa]ppetite", !Lookup.MajorType == "Symptom"}):SymptomAppetiteOnly
    ({Token,!Split})[0,3]
     {Token.category != ","}
    ({Lookup.minorType == "good"} | 
     {Lookup.minorType == "poor"}):descriptorsOfAppetite

):AppetiteDescription
--&gt;
:AppetiteDescription.Appetite = {rule = "AppetiteDescription5", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = "no"}




Rule: AppetiteThenDescriber
Priority: 7
(

    ({Lookup.minorType == negation}):Negationwords
    ({Token,!Split})[0,3]
    ({Lookup.minorType == "good"}  | 
     {Lookup.minorType == "poor"}):descriptorsOfAppetite
    ({Token,!Split})[0,3]
    ({Token.string =~ "[Aa]ppetite", !Lookup.MajorType == "Symptom"}):SymptomAppetiteOnly

):AppetiteDescriptionwithNegation
--&gt;
:AppetiteDescriptionwithNegation.Appetite = {rule = "AppetiteDescriptionwithNegation6", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = "yes"}




Rule: AppetiteThenDescriber
Priority: 6
(

    ({Token.string =~ "[Aa]ppetite", !Lookup.MajorType == "Symptom"}):SymptomAppetiteOnly   
    ({Token,!Split})[0,3]
    ({Lookup.minorType == negation}):Negationwords
    ({Token,!Split})[0,3]
    ({Lookup.minorType == "good"}  | 
     {Lookup.minorType == "poor"}):descriptorsOfAppetite

):AppetiteDescriptionwithNegation
--&gt;
:AppetiteDescriptionwithNegation.Appetite = {rule = "AppetiteDescriptionwithNegation7", AppetiteType = :descriptorsOfAppetite.Lookup.minorType, ApplyNegation = "yes"}




Rule: AppetiteThenDescriber
Priority: 6
(

    ({Token.string =~ "[Nn]o"})
    ({!Token.string == "change"})
    ({Token,!Split})[0,3]
    ({Token.string =~ "[Aa]ppetite", !Lookup.MajorType == "Symptom"}):SymptomAppetiteOnly
    ({Token.string =~ "[Pp]roblems"})

):AppetiteDescriptionwithNegation
--&gt;
:AppetiteDescriptionwithNegation.Appetite = {rule = "AppetiteDescriptionwithNegation8", AppetiteType = "good" ApplyNegation = "no"}
</code></pre>

<hr>

<h1>
<a id="testing-the-gazateer-and-jape-code" class="anchor" href="#testing-the-gazateer-and-jape-code" aria-hidden="true"><span class="octicon octicon-link"></span></a>TESTING THE GAZATEER and JAPE CODE</h1>

<p>We need to some Gold Standard data to test the above Gazateers and Code. </p>

<h3>
<a id="gold-standard-data" class="anchor" href="#gold-standard-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Gold Standard data</h3>

<p>500 documents extracted from CRIS. Each document contains the word "appetite"</p>

<p>These documents were annotated by two individuals to code good or bad appeite accoding to the <a href="https://cloud.githubusercontent.com/assets/10629155/12238166/95b70598-b87a-11e5-9fe6-dcefe1bd904b.png">GOLD STANDARD RULES</a>. </p>

<p>The inter-rater reliability was quite high - above 85% (but i don't have exact figures). </p>

<h3>
<a id="final-performance" class="anchor" href="#final-performance" aria-hidden="true"><span class="octicon octicon-link"></span></a>Final Performance</h3>

<p>Testing on Gold Standard data (500 documents) generated a precision of 80% and a recall of 73%.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Appetite-textmining-code maintained by <a href="https://github.com/andreafernandes">andreafernandes</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
